# OpenAPI version identifier - required for OpenAPI 3.0 domains
openapi: 3.0.0

#######################
# Optional info section
#######################
info:
  title: DCSA Components
  description: Common components for DCSA APIs
  version: '1.0.0'

components:
 

  ####################
  # Common data models
  ####################
  schemas:
    transportDocument:
      type: object
      properties:
        transportDocumentID: 
          $ref: '#/components/schemas/transportDocumentID'
        shippingInstructionID:
          $ref: '#/components/schemas/shippingInstructionID'
        transportDocumentTypeCode:
          $ref: '#/components/schemas/transportDocumentTypeCode'
        documentStatus:
          $ref: '#/components/schemas/documentStatus'
        totalContainerWeight:
          $ref: '#/components/schemas/totalContainerWeight'
        onboardDate:
          $ref: '#/components/schemas/onboardDate'
        paymentTerm:
          $ref: '#/components/schemas/paymentTerm'
        termsAndConditions:
          $ref: '#/components/schemas/termsAndConditions'
        placeOfIssue:
          $ref: '#/components/schemas/placeOfIssue'
        tareWeight:
          $ref: '#/components/schemas/tareWeight'
        chargeType:
          $ref: '#/components/schemas/chargeType'
        clauseContent:
          $ref: '#/components/schemas/clauseContent'
        receivedForShipmentDate:
          $ref: '#/components/schemas/receivedForShipmentDate'
        currencyCode:
          $ref: '#/components/schemas/currencyCode'
    shippingInstruction:
      description: The Shipping Instruction is â€˜an enrichment to the original booking shared by the shipper to the carrier. The shipping instruction includes volume/weight, shipping dates, origin, destination and other special instructions. The information given by the shipper through the shipping instructions is the information, which is required to create the Bill of Lading.
      type: object
      properties:
        callbackUrl:
          $ref: '#/components/schemas/callbackUrl'
        shippingInstructionID:
          $ref: '#/components/schemas/shippingInstructionID'
        isElectronic:
          $ref: '#/components/schemas/isElectronic'
        shipment:
          $ref: '#/components/schemas/shipment'
        equipments:
          type: array
          items:
            $ref: '#/components/schemas/equipment'
        cargoItems:
          type: array
          items:
            $ref: '#/components/schemas/cargoItem'
        stuffing:
          type: array
          items:
            $ref: '#/components/schemas/stuffingItem'
      required:
        - callbackUrl
        - shippingInstructionID
        - isElectronic
        - shipment
        - equipments
        - cargoItems
        - stuffing
    shipment:
      type: object
      properties:
        shipmentID:
          $ref: '#/components/schemas/shipmentID'
        carrierCode:
          $ref: '#/components/schemas/carrierCode'
        exportReferenceNumber:
          $ref: '#/components/schemas/exportReferenceNumber'
        transportReference:
          $ref: '#/components/schemas/transportReference'
        carrierVoyageNumber:
          $ref: '#/components/schemas/carrierVoyageNumber'
        parties:
          type: array
          items: 
            $ref: '#/components/schemas/party'
        locations:
          type: array
          items:
            $ref: '#/components/schemas/location'
        serviceType:
          $ref: '#/components/schemas/serviceType'
        shipmentTerm:
          $ref: '#/components/schemas/shipmentTerm'
        freightPayableAt:
          $ref: '#/components/schemas/freightPayableAt'
        shipmentEquipmentQuantity:
          $ref: '#/components/schemas/shipmentEquipmentQuantity'
        currencyCode:
          $ref: '#/components/schemas/currencyCode'
        SVCContract:
          $ref: '#/components/schemas/SVCContract'
      required:
        - carrierBookingReference
        - carrierCode
        - exportReferenceNumber
        - transportReference
        - carrierVoyageNumber
        - parties
        - locations
        - serviceType
        - shipmentTerm
        - freightPayableAt
        - paymentTerm
        - shipmentEquipmentQuantity
    equipment:
      type: object
      properties:
        equimentID:
          $ref: '#/components/schemas/equipmentID'
        equipmentReference:
          $ref: '#/components/schemas/equipmentReference'
        ISOEquipmentCode:
          $ref: '#/components/schemas/ISOEquipmentCode'
        sealNumber:
          $ref: '#/components/schemas/sealNumber'
        sealSource:
          $ref: '#/components/schemas/sealSource'
        tareWeight:
          $ref: '#/components/schemas/tareWeight'
      required:
        - equipmentReference
        - ISOEquipmentCode
      
    cargoItem:
      type: object
      properties:
        cargoItemID:
          $ref: '#/components/schemas/cargoItemID'
        descriptionOfGoods:
          $ref: '#/components/schemas/descriptionOfGoods'
        carrierBookingReference:
          $ref: '#/components/schemas/carrierBookingReference'  
        HSCode:
          $ref: '#/components/schemas/HSCode'
        weight:
          $ref: '#/components/schemas/weight'
        volume:
          $ref: '#/components/schemas/volume'
        weightUnit:
          $ref: '#/components/schemas/weightUnit'
        volumeUnit:
          $ref: '#/components/schemas/volumeUnit'
        verifiedGrossMass:
          $ref: '#/components/schemas/verifiedGrossMass'
        declaredValue:
          $ref: '#/components/schemas/declaredValue'
        packageCode:
          $ref: '#/components/schemas/packageCode'
        shippingMarks:
          $ref: '#/components/schemas/shippingMarks'
      required:
        - descriptionOfGoods
        - HSCode
        - weight
        - volume
        - weightUnit
    isElectronic:
      type: boolean
      description: Indicates whether the Transport Document is electronic or not
      example: true
    HSCode:
      type: string
      maxLength: 10
      description: The Harmonized System is an international nomenclature for the classification of products. It allows participating countries to classify traded goods on a common basis for customs purposes. At the international level, the Harmonized System (HS) for classifying goods is a six-digit code system.
      example: MISSING
    packageCode:
      type: string
      maxLength: 10
      example: MISSING
    partyName:
      type: string
      description: Name of the party.
      example: "Great Books ApS"
      maxLength: 100
    phoneNumber: 
      type: string
      description: The contact number of the individual or party, including country specific dialing codes.
      example: "+45 4512 1231"
      maxLength: 20
    email:
      type: string
      description: Unique identifier for an email account of a party which is used to both send and receive email messages over the Internet.
      example: john@example.com
      maxLength: 250
    shipmentTerm:
      type: string
      description: 
        'Indicates the shipment term for the loading of the cargo into the Container or for the unloading of the cargo out of the Container. Three options are defined by DCSA: FCL, LCL and BB.'
      enum:
        - FCL
        - LCL
        - BB
      example: FCL
    numberOfOriginals:
      type: integer
      example: 3
      maxLength: 10
      description: 'Number of original copies of the negotiable bill of lading which has been issued to the customer. Condition: only applicable for physical Bill of Lading'
    taxReference:
      type: string
      example: MISSING
      maxLength: 20
      description: 'It is an identifying number of consignee or shipper (Individual or entity) used for tax purposes. Condition: Conditional based on customs requirements.'
    sealSource:
      type: integer
      example: MISSING
      description: 'The source of seal, namely who has affixed the seal. This attribute links to the Seal Source ID defined in the Seal Source reference data entity. Condition: Conditional on type of commodity'
    tareWeight:
      type: integer
      example: 12000
      description: 'The weight of an empty container. Condition: Only with shipper owned containers.'
    clauseContent:
      type: string
      example: MISSING
      description: "The content of the clause. Condition: Clauses added by the carrier to the bill of lading subject to local rules / guidelines or certain mandatory information required to be shared with the customer. Is not a separate field on the bill of lading and usually printed below cargo description"
    shippingMarks:
      type: string
      description: The identifying details on a package or the actual markings that appear on the package(s). This information is provided by the customer.
      example: MISSING
    exportReferenceNumber:
      type: integer
      description: The unique identifier of the export license classification provided by the shipper for control purposes relevant to regulatory procedures.
      example: QWQ12313832
    carrierCode: 
      type: string
      description: The Carrier Code represents a concatenation of the Code List Provider Code and the Code List Provider. A hyphen is used between the two codes. The unique carrier identifier is sourced from either the NMFTA SCAC codes list or the SMDG Liner Code List.
      maxLength: 10
      example: MISSING
    currencyCode: 
      type: string
      maxLength: 3
      description: The currency code for the amount of the charge, using a 3-character code (ISO 4217).
      example: MISSING
    paymentTerm:
      type: string
      maxLength: 3
      description: An indicator of whether a charge is prepaid or collect, using a 3-character code to identify INCO terms.
    currencyAmount: 
      type: number
      description: The monetary value of all freight and other service charges for this consignment item, with a maximum of 2 digits decimals.
      example: 1012.12
    SVCContract:
      type: string
      maxLength: 30
      description: Reference number for agreement between shipper and carrier through which the shipper commits to provide a certain minimum quantity of cargo over a fixed period and the carrier commits to a certain rate or rate schedule
      example: MISSING
    transportReference:
      type: string
      example: MISSING
      description: The reference for the transport, e.g. when the mode of transport is a vessel, the Transport Reference will be the vessel IMO number.
      maxLength: 50
    carrierVoyageNumber:
      type: string
      example: 2013W
      description: The vessel operator specific identifier of the Voyage
      maxLength: 50
    descriptionOfGoods:
      type: string
      example: MISSING
      description: The cargo description are details which accurately and properly describe the cargo being shipped in the container(s) as provided by the shipper.
      maxLength: 2000
    weight:
      type: integer
      example: 13000
      description: The total weight of the cargo including packaging items being carried in the container(s). Excludes the tare weight of the container(s)
    volume:
      type: integer
      example: 12
      description: Calculated by multiplying the width, height and length of the packed cargo
    weightUnit:
      type: string
      example: KGM
      description: The unit of measure; it can be in either Kilograms or Pounds as provided by the shipper.
      enum:
        - KGM
        - LBR
      maxLength: 20
    volumeUnit:
      type: string 
      example: MISSING
      description: The unit of measure. It can be in either Kilograms or Pounds as provided by the shipper.
      maxLength: 20
    freightPayableAt:
      type: string
      format: uuid
      example: MISSING
      description: It is the location where payment will take place by the customer. Usually refers to Basic Ocean Freight alone. This attribute links to the Location ID.
    dateOfIssue:
      type: string
      format: date
      example: MISSING
      description: Date when the original transport document (bill of lading) has been issued.

    ISOEquipmentCode:
      type: string
      example: MISSING
      description: Unique code for the different equipment size/type used for transporting commodities. The code is a concatenation of ISO Equipment Size Code and ISO Equipment Type Code A and follows the ISO 6346 standard.
      maxLength: 4
    shipmentEquipmentQuantity:
      type: integer
      example: 2
      description: The number of containers linked to the shipment.
    serviceType:
      type: string
      enum:
        - CY
        - SD
        - CFS
      description: 'Indicates the type of service offered at the origin or destination. Three options are defined by DCSA: CY, SD and CFS.'
      example: CY
    documentReferenceNumber:
      type: string
      description: Addresses the bill of lading number when the document type is bill of lading. It is a unique number allocated by the shipping line and is the main number used for the tracking of the status of the shipment.
      maxLength: 20
      example: MISSING

    partyRole:
      type: string
      enum:
        - ISSUER
        - SHIPPER
        - CONSIGNEE
        - NOTIFY_PARTY
        - ALSO_NOTIFY
        - FORWARDING_AGENT
      example: ISSUER
      description: MISSING
    locationID:
      type: string
      format: uuid
      example: MISSING
      description: MISSING 
    locationTypeCode:
      type: string
      description: Code for location types. PRE (Place of Receipt), PDE (Place of Delivery), PCB (Pre-carriage by), OIR (Onward In-land Routing), PLO (Port of Loading), PDI (Port of Discharge), ORI (Origin of Goods)
      enum:
        - PRE
        - PDE
        - PCB 
        - OIR
        - PLO
        - PDI
        - ORI
    sealNumber:
      type: string
      maxLength: 15
      description: An Identification of a seal affixed to the container
      example: MISSING
    verifiedGrossMass:
      type: number
      description: A document informing the carrier of the weight of the container, signed by an authorized person from the shipper or on beholf of said shipper. This includes cargo weight, bracing, dunnage and container tare weight
      example: MISSING
    declaredValue:
      type: number
      description: The value of the cargo that the shipper declares in order to avoid the carrier's limitation of liability and "Ad Valorem" freight, i.e. freight which is calculated based on the value of the goods declared by the shipper.
      example : 1231.10
    signature:
      type: string
      maxLength: 500
      description: Digital signature
      example: MISSING
    fax:
      type: string
      maxLength: 20
      description: MISSING
      example: "+33 (5) 35 1231 11"
    shippingInstructionID:
      type: string
      example: d9c69bc8-294d-46d1-807c-654598341374
      format: uuid
      description: The identifier for a shipping instruction
    cargoItemID:
      type: string
      example: d9c69bc8-294d-46d1-807c-654598341374
      format: uuid
      description: The identifier for a Cargo Item
    equipmentID:
      type: string
      example: d9c69bc8-294d-46d1-807c-654598341374
      format: uuid
      description: The identifier for an equipment
    shipmentID:
      type: string
      example: d9c69bc8-294d-46d1-807c-654598341374
      format: uuid
      description: The identifier for an equipment  
      
    documentStatus:
      type: string
      enum:
        - SI
        - RECEIVED
        - DRAFTED
        - PENDING_APPROVAL
        - APPROVED
        - ISSUED
        - SURRENDERED
      description: The current status of the transport document, e.g. SI, Received, Drafted, Pending Approval, Approved, Issued, and Surrended. 
    totalContainerWeight:
      type: number
      description: Total Container Weight includes Cargo Gross Weight and Container Tare Weight
    onboardDate:
      type: string
      format: date
      description: The date when the last cntainer linked to the bill of lading is loaded on board the vessel indicated on the bill of lading.
    shippedOnboardDate:
      type: string
      format: date
      description: The date when the last container linked to the bill of lading is loaded on board the vessel indicated on the bill of lading.
    termsAndConditions:
      type: string
      description: Additional carrier terms and conditions aside from the general terms and conditions.
    placeOfIssue:
      type: string
      format: uuid
      description: 'Links to the locationID to specify where the original transport document (bill of lading) has been issued. Condition: Only applicable for physical Bill of Lading'
    chargeType:
      type: string
      maxLength: 20
      description: 'Description of the charge type applied. Condition: Subject to country requirements'
    receivedForShipmentDate:
      type: string
      format: date
      description: Date when the last container linked to the transpot document is physically in the terminal (Customers cleared against the intended vessel)
      example: "2020-12-12"
    transportDocumentID:
      type: string
      format: uuid
      description: The unique identifier for a transport document
    
    reason:
      type: string
      description: Reason field in a callback response. This field can be used to explain why a specific callbackStatus has been sent.
      example: Please update the final draft TD.
    documentID:
      type: string
      format: uuid
      description: The id of the object in question, for the callback response.
    callbackStatus:
      type: string
      enum:
        - REQUEST_UPDATE_SI
        - PUBLISH_DRAFT_TD
        - PUBLISH_FINAL_DRAFT_TD
        - APPROVE_FINAL_DRAFT_TD
        - REQUEST_AMENDMENTS_FINAL_DRAFT_TD
        - APPROVE_AMENDMENTS_FINAL_DRAFT_TD
        - PUBLISH_TD
        - REQUEST_AMENDMENTS_TD
        - APPROVE_AMENDMENTS_TD
      description: The type of callback response, indicating what has happened to the object in question.
      example: REQUEST_AMENDMENTS_FINAL_DRAFT_TD
      
      ### objects
    party:
      description: â€˜Partyâ€™ is an array of Party Type, Party Name, E-mail, Phone number, Fax and Tax Reference attributes. Classification for this Use Case (Required (R), Conditional (C), Optional (O), Not Applicable (N/A)) is given per attribute.
      type: object
      properties:
        partyRole:
          $ref: '#/components/schemas/partyRole'
        partyName:
          $ref: '#/components/schemas/partyName'
        email:
          $ref: '#/components/schemas/email'
        phoneNumber:
          $ref: '#/components/schemas/phoneNumber'
        fax:
          $ref: '#/components/schemas/fax'
        taxReference: 
          $ref: '#/components/schemas/taxReference'
    parties:
      type: array
      items:
        $ref: '#/components/schemas/party'
    locations:
      type: array
      items:
        $ref: '#/components/schemas/location'
    location:
      description: Locations are arrays of a location identifier (e.g. â€˜Location IDâ€™) attribute and the Location Type Code attribute
      type: object    
      properties:
        locationID:
          $ref: '#/components/schemas/locationID'
        locationTypeCode:
          $ref: '#/components/schemas/locationTypeCode'
          
    callbackObject:
      description: The standard callback object.
      type: object
      properties:
        documentID:
          $ref: '#/components/schemas/documentID'
        callbackStatus:
          $ref: '#/components/schemas/callbackStatus'
        reason:
          $ref: '#/components/schemas/reason'
    vesselIMONumber:
      description: The identifier of vessel for which schedule details are published. Depending on schedule type, this may not be available yet.
      type: string
      maxLength: 7
      example: 1801323    
    equipmentReference:
      type: string
      example: APZU4812090
      maxLength: 15
      description: The unique identifier for the equipment, which should follow the BIC ISO Container Identification Number where possible. If a container is not yet assigned to a shipment, the interface cannot return any information when an equipment reference is given as input. If a container is assigned to an (active) shipment, the interface returns information on the active shipment.
    carrierBookingReference:
      type: string
      maxLength: 35
      example: ABC709951
      description: The identifier for a shipment, which is issued by and unique within each of the carriers.
    callbackUrl:  
      type: string
      format: uri
      example: https://myserver.com/send/callback/here
      description: Your server, where the API server should send the event data
    transportDocumentTypeCode:
      type: string
      enum:
        - BOL
        - SWB
      description: | 
        The Transport Document Type is used to identify which type of document, the value of "transportDocumentID" represents. The values available are:
        - BOL (Bill of Lading)
        - SWB (Sea Waybill)
      example: SWB
    stuffingItem:
      type: object
      properties:
        equipmentReference:
          $ref: '#/components/schemas/equipmentReference'
        shippingMarks:
          type: array
          items:
            $ref: '#/components/schemas/shippingMarks'
    error:
      type: object
      required:
        - httpMethod
        - requestUri
        - errors
        - statusCode
        - statusCodeText
        - errorDateTime
      properties:
        httpMethod:
          description: The HTTP request method type
          type: string
          example: POST
        requestUri:
          description: The request URI.
          type: string
          example: https://dcsa.org/dcsa/tnt/v1/events
        errors:
          $ref: '#/components/schemas/errors'
        statusCode:
          description: The HTTP status code
          type: integer
          example: 400
        statusCodeText:
          description: The textual representation of the response status.
          type: string
          example: Bad Request
        errorDateTime:
          description: The date and time (in ISO 8601 format) the error occured.
          type: string
          example: '2019-11-12T07:41:00+08:30'
    errors:
      type: array
      items:
        type: object
        properties:
          reason:
            description: High level error message.
            type: string
            example: invalidQuery
          message:
            description: Detailed error message.
            type: string
            example: The request did not contain one of the three required query parameters.
        required:
         - reason
         - message

  ####################
  # Common parameters
  ####################
  parameters:
    limitParam:
      name: limit
      in: query
      description: Maximum number of items to return.
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1
      #  maximum: 100
        default: 100 
      example: 100
    cursorParam:
      name: cursor
      in: query
      description: A server generated value to specify a specific point in a collection result, used for pagination.
      required: false
      schema:
        type: string
      example: abc123     

  #######################
  # Common request bodies
  #######################


  ####################
  # Common responses
  ####################

  #########################
  # Common headers
  # (except request headers - they are defined as parameters)
  #########################
  headers:
    signatureHeader:
      schema:
        type: object
        properties:
          keyId:
            type: string
            format: uuid
            example: 123e4567-e89b-12d3-a456-426614174000
          created:
            type: integer
            example: 1591960384 
          headers:
            type: string
            example: "(request-target) (created) date host"
          signature:
            type: string
            example: aGkgZnJvbSBkZW5tYXJr

  #######################
  # Common path items
  #######################

  #########################
  # Common link definitions
  # See: https://swagger.io/docs/specification/links/
  #########################

  #########################
  # Common callback definitions
  # See: https://swagger.io/docs/specification/callbacks/
  #########################